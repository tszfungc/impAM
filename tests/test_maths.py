import numpy as np

from impam.cli import cmvn


def test_cmvn():

    S = [
        [1.9769772, 0.9926958, -0.7683334, 1.4721776, -1.1671920],
        [0.9926958, 5.8264792, 1.6819576, 1.5636918, 2.5196076],
        [-0.7683334, 1.6819576, 11.5558134, 0.5160487, 0.4150373],
        [1.4721776, 1.5636918, 0.5160487, 2.1645987, -0.9692929],
        [-1.1671920, 2.5196076, 0.4150373, -0.9692929, 3.0664314],
    ]
    impute_ind = 2
    Z_o = [1, 1, 0, -1]
    res_mean = cmvn(Z_o, S, impute_ind)

    assert np.isclose(res_mean, 3.587814, 1e-3)
